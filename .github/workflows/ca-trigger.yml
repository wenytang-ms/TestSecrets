name: CA trigger

on:
  workflow_run:
    workflows: ["CA"]
    branches: ["main", "develop", "ga"]
    types: ["completed"]

jobs:
  DownloadAndOutput:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    steps:
      - name: download artifact from latest CD pipeline
        id: down
        run: |
          id=$(curl https://api.github.com/repos/OfficeDev/TeamsFx/actions/workflows/22583747/runs | jq '.workflow_runs[0].id')
          gh run download $id -n release.txt
          cat release.txt